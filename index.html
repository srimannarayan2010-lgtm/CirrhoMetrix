<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CirrhoMetrix</title>
    <style>
        body {
            font-family: Lora', serif;
            margin: 0;
            background-color: #f4f4f9;
            color: #333;
        }
        .header-container {
            background-color: ##F5F5F5;
            padding: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        .header-content {
            max-width: 1200px;
            margin: auto;
        }
        .header-content img {
            width: 400px;
            height: auto;
        }
        .subtitle {
            text-align: center;
            color: #555;
            margin-top: 5px;
            margin-bottom: 25px;
            font-size: 2.1em;
        }
        .container {
            max-width: 1600px;
            margin: 20px auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .input-columns {
            display: flex;
            flex-wrap: wrap; 
            gap: 40px; 
            justify-content: center; /* This centers the content */
        }
        .clinical-column, .lab-column {
            flex: 1; 
            min-width: 300px; 
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="number"], input[type="text"], input[type="date"], select {
            width: 50%; 
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #F8B195;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .impression-box {
            margin-top: 30px;
            padding: 20px;
            background-color: #f0f8ff;
            border: 1px solid #cceeff;
            border-radius: 8px;
            display: none;
        }
        .impression-box h3 {
            color: #0056b3;
            margin-top: 0;
            text-align: center;
        }
        .impression-box p {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            color: #777;
            font-size: 0.9em;
        }
        /* Mobile compatibility */
        @media (max-width: 768px) {
            .header-content img {
                width: 200px;
            }
            .input-columns {
                flex-direction: column;
                gap: 0;
            }
            input[type="number"], input[type="text"], input[type="date"], select {
                width: 100%;
            }
        }
        /* Sidebar styles */
        .sidebar {
            height: 100%;
            width: 0;
            position: fixed;
            z-index: 1;
            top: 0;
            left: 0;
            background-color: #111;
            overflow-x: hidden;
            transition: 0.5s;
            padding-top: 60px;
        }
        .sidebar a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 25px;
            color: #F8B195;
            display: block;
            transition: 0.3s;
        }
        .sidebar a:hover {
            color: #f1f1f1;
        }
        .sidebar .closebtn {
            position: absolute;
            top: 0;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
        }
        .hamburger {
            font-size: 30px;
            cursor: pointer;
            position: fixed;
            top: 10px;
            left: 15px;
            z-index: 2;
            color: #F8B195;
        }
    </style>
<link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <div id="mySidebar" class="sidebar">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="#about">About</a>
        <a href="#contact">Contact Us</a>
    </div>
    <div class="hamburger" onclick="openNav()">&#9776;</div>
    
    <header class="header-container">
        <div class="header-content">
            <img src="CirrhoMetrix_logo.png" alt="CirrhoMetrix Medical Logo">
            <p class="subtitle">Cirrhosis management simplified</p>
        </div>
    </header>

    <div class="container">
        
        
        <form id="calculatorForm">
            <div class="input-columns">
                <div class="clinical-column">
                    <h2>Clinical Parameters</h2>
                    
                    <div class="input-group">
                        <label for="gender">Gender</label>
                        <select id="gender" name="gender" required>
                            <option value="">Select Gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="etiology">Etiology</label>
                        <input type="text" id="etiology" name="etiology" placeholder="e.g., Alcohol, Viral, etc.">
                    </div>
                    
                    <div class="input-group">
                        <label for="encephalopathy">Grade of Hepatic Encephalopathy</label>
                        <select id="encephalopathy" name="encephalopathy">
                            <option value="0">None</option>
                            <option value="1">Grade 1</option>
                            <option value="2">Grade 2</option>
                            <option value="3">Grade 3</option>
                            <option value="4">Grade 4</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="ascites">Ascites</label>
                        <select id="ascites" name="ascites">
                            <option value="none">None</option>
                            <option value="mild">Mild</option>
                            <option value="moderate">Moderate</option>
                            <option value="severe">Severe</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="sbp">Spontaneous Bacterial Peritonitis (SBP)</label>
                        <select id="sbp" name="sbp">
                            <option value="no">No</option>
                            <option value="yes">Yes</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="varices">Variceal Status</label>
                        <select id="varices" name="varices">
                            <option value="none">None</option>
                            <option value="small">Small</option>
                            <option value="large">Large</option>
                        </select>
                    </div>
                </div>

                <div class="lab-column">
                    <h2>Lab Parameters</h2>
                    
                    <div class="input-group">
                        <label for="platelets">Platelets (x10^5/L)</label>
                        <input type="number" id="platelets" name="platelets" step="0.1">
                    </div>
                    <div class="input-group">
                        <label for="creatinine">Creatinine (mg/dL)</label>
                        <input type="number" id="creatinine" name="creatinine" step="0.1"placeholder="Enter not more than 1 decimal" required>
                    </div>
                    <div class="input-group">
                        <label for="sodium">Sodium (mEq/L)</label>
                        <input type="number" id="sodium" name="sodium" step="0.1" required>
                    </div>
                    <div class="input-group">
                        <label for="bilirubin">Total Bilirubin (mg/dL)</label>
                        <input type="number" id="bilirubin" name="bilirubin" step="0.1" required>
                    </div>
                    <div class="input-group">
                        <label for="inr">INR</label>
                        <input type="number" id="inr" name="inr" step="0.01" required>
                    </div>
                    <div class="input-group">
                        <label for="albumin">Albumin (g/dL)</label>
                        <input type="number" id="albumin" name="albumin" step="0.1" required>
                    </div>
                </div>
            </div>
            
            <button type="submit">Calculate Scores</button>
        </form>

        <div id="impression" class="impression-box">
            <h3>Clinical Impression</h3>
            <p><strong>Cirrhosis Status:</strong> <span id="imp_cirrhosisStatus">[Compensated/Decompensated]</span></p>
            <p><strong>Child-Pugh Score:</strong> <span id="imp_childPugh">[Score] - [Class A/B/C]</span></p>
            <p><strong>MELD-Na Score:</strong> <span id="imp_meldNa">[Score]</span></p>
            <p><strong>MELD 3.0 Score:</strong> <span id="imp_meld3">[Score]</span></p>
            <p><strong>Risk Factors:</strong> <span id="imp_riskFactors">[Etiology]</span></p>
            <p><strong>Portal Hypertension:</strong> <span id="imp_portalHypertension">[Variceal status]</span></p>
            <p><strong>Ascites:</strong> <span id="imp_ascitesStatus">[Ascites status]</span></p>
            <p><strong>SBP:</strong> <span id="imp_sbpStatus">[Yes/No]</span></p>
            <p><strong>Hepatic Encephalopathy:</strong> Grade <span id="imp_heGrade">[Grade]</span></p>
            <p><strong>AKI:</strong> <span id="imp_akiStatus">[Yes/No - will require calculation logic]</span></p>
        </div>
        
        <div id="about" style="display: none;">
            <h3>About CirrhoMetrix</h3>
            <p>CirrhoMetrix is a web-based prognostic tool developed to support medical professionals and students in assessing the severity of liver disease in patients with cirrhosis. It accurately calculates and summarizes key prognostic scores, including the Child-Pugh, MELD-Na, and MELD 3.0 scores, based on validated clinical and laboratory parameters.</p>
            <p>This tool was created as a part of a medical gastroenterology residency thesis project by Dr R Sriman Narayan Reddy, with the aim of providing a simple and reliable resource for clinical research and decision-making.</p>
            <button id="backToCalcAbout" type="button">Back to Calculator</button>
        </div>

        <div id="contact" style="display: none;">
            <h3>Contact Us</h3>
            <p>For inquiries, feedback, or collaboration, please feel free to reach out:</p>
            <ul>
                <li>Email: sriman.narayan2010@gmail.com</li>
                <li>LinkedIn: www.linkedin.com/in/dr-r-sriman-narayan-reddy-a35a3a344</li>
            </ul>
            <p>Thank you for your interest in CirrhoMetrix. Your input is valuable as we work to improve this tool.</p>
            <button id="backToCalcContact" type="button">Back to Calculator</button>
        </div>
        
        <div class="footer">
            Developed by Dr R Sriman Narayan Reddy
        </div>
    </div>
    
    <script>
        // Sidebar functions
        function openNav() {
            document.getElementById("mySidebar").style.width = "250px";
        }
        function closeNav() {
            document.getElementById("mySidebar").style.width = "0";
        }
        
        // Function to show/hide sections
        function showSection(sectionId) {
            // Hide all sections first
            document.getElementById("calculatorForm").style.display = "none";
            document.getElementById("impression").style.display = "none";
            document.getElementById("about").style.display = "none";
            document.getElementById("contact").style.display = "none";
            
            // Show the requested section
            document.getElementById(sectionId).style.display = "block";
        }
        
        // Set up event listeners for the new links
        document.addEventListener("DOMContentLoaded", function() {
            document.querySelector('.sidebar a[href="#about"]').onclick = function() {
                showSection('about');
                closeNav();
            };
            document.querySelector('.sidebar a[href="#contact"]').onclick = function() {
                showSection('contact');
                closeNav();
            };
            // Set up event listeners for the "Back to Calculator" buttons
            document.getElementById("backToCalcAbout").onclick = function() {
                showSection('calculatorForm');
                document.getElementById("impression").style.display = "none";
            };
            document.getElementById("backToCalcContact").onclick = function() {
                showSection('calculatorForm');
                document.getElementById("impression").style.display = "none";
            };

            // Initial state: Show the calculator form by default
            showSection('calculatorForm');
        });

        // Main calculation logic
        document.getElementById('calculatorForm').addEventListener('submit', function(event) {
            event.preventDefault();

            // Get the values from the form inputs
            const gender = document.getElementById('gender').value;
            const etiology = document.getElementById('etiology').value;
            const encephalopathy = document.getElementById('encephalopathy').value;
            const ascites = document.getElementById('ascites').value;
            const sbp = document.getElementById('sbp').value;
            const varices = document.getElementById('varices').value;
            
            const creatinine = parseFloat(document.getElementById('creatinine').value);
            const sodium = parseFloat(document.getElementById('sodium').value);
            const bilirubin = parseFloat(document.getElementById('bilirubin').value);
            const inr = parseFloat(document.getElementById('inr').value);
            const albumin = parseFloat(document.getElementById('albumin').value);
            
            // Input Validation
            if (isNaN(creatinine) || isNaN(sodium) || isNaN(bilirubin) || isNaN(inr) || isNaN(albumin)) {
                alert("Please fill in all required lab parameters.");
                return;
            }

            // Child-Pugh Score Calculation
            let totalScore = 0;
            
            if (bilirubin < 2.0) {
                totalScore += 1;
            } else if (bilirubin >= 2.0 && bilirubin <= 3.0) {
                totalScore += 2;
            } else {
                totalScore += 3;
            }
            
            if (albumin > 3.5) {
                totalScore += 1;
            } else if (albumin >= 2.8 && albumin <= 3.5) {
                totalScore += 2;
            } else {
                totalScore += 3;
            }

            if (inr < 1.7) {
                totalScore += 1;
            } else if (inr >= 1.7 && inr <= 2.3) {
                totalScore += 2;
            } else {
                totalScore += 3;
            }
            
            if (ascites === 'none') {
                totalScore += 1;
            } else if (ascites === 'mild') {
                totalScore += 2;
            } else {
                totalScore += 3;
            }
            
            if (encephalopathy === '0') {
                totalScore += 1;
            } else if (encephalopathy === '1' || encephalopathy === '2') {
                totalScore += 2;
            } else {
                totalScore += 3;
            }

            // MELD and MELD-Na Score Calculation
            const creat = Math.max(1, creatinine);
            const bil = Math.max(1, bilirubin);
            const inrVal = Math.max(1, inr);
            const sod = Math.min(Math.max(sodium, 125), 140);
            
            let meldI = (0.957 * Math.log(creat) + 0.378 * Math.log(bil) + 1.120 * Math.log(inrVal) + 0.643);
            let meldScore = Math.round(meldI * 10);
            if (creatinine > 4.0) {
                meldScore = Math.round(10 * (0.957 * Math.log(4.0) + 0.378 * Math.log(bil) + 1.12 * Math.log(inrVal) + 0.643));
            }
            
            let meldNaScore;
            if (meldScore > 11) {
                meldNaScore = meldScore + 1.32 * (137 - sod) - (0.033 * meldScore * (137 - sod));
                meldNaScore = Math.round(meldNaScore);
            } else {
                meldNaScore = meldScore;
            }

            // MELD 3.0 Score Calculation
            const age = 50; 
            const femaleFactor = (gender === 'female') ? 1.05 : 1.0;
            const meld3Creat = Math.min(creatinine, 3.0);
            const meld3Albumin = Math.min(albumin, 4.0);
            
            let meld3Score = (11.14 * Math.log(meld3Creat) + 9.09 * Math.log(inr) + 4.56 * Math.log(bilirubin) + 0.82 * (137 - sodium) + 1.85 * (3.5 - meld3Albumin) + 1 * (age - 20) * 0.09) * femaleFactor;
            meld3Score = Math.round(Math.max(meld3Score, 10));
            
            // Clinical Impression Logic
            let cirrhosisStatus = 'Compensated';
            if (ascites !== 'none' || encephalopathy !== '0' || varices !== 'none' || sbp === 'yes') {
                cirrhosisStatus = 'Decompensated';
            }
            
            let portalHypertensionText = varices !== 'none' ? `${varices} varices` : 'No varices';
            let ascitesStatusText = ascites !== 'none' ? `${ascites} ascites` : 'No ascites';

            let akiStatus = (creatinine > 1.5) ? 'Yes' : 'No';

            // Update the HTML with the calculated values
            document.getElementById('imp_cirrhosisStatus').textContent = cirrhosisStatus;
            document.getElementById('imp_childPugh').textContent = `${totalScore} - Class ${getChildPughClass(totalScore)}`;
            document.getElementById('imp_meldNa').textContent = meldNaScore;
            document.getElementById('imp_meld3').textContent = meld3Score;
            document.getElementById('imp_riskFactors').textContent = etiology || 'Not specified';
            document.getElementById('imp_portalHypertension').textContent = portalHypertensionText;
            document.getElementById('imp_ascitesStatus').textContent = ascitesStatusText;
            document.getElementById('imp_sbpStatus').textContent = (sbp === 'yes') ? 'Yes' : 'No';
            document.getElementById('imp_heGrade').textContent = encephalopathy;
            document.getElementById('imp_akiStatus').textContent = akiStatus;

            document.getElementById('impression').style.display = 'block';

            function getChildPughClass(score) {
                if (score >= 5 && score <= 6) {
                    return 'A';
                } else if (score >= 7 && score <= 9) {
                    return 'B';
                } else {
                    return 'C';
                }
            }
        });
    </script>
</body>
</html>
